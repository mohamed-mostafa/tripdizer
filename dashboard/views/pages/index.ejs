<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>HSW | Dashboard</title>
  <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
  <!-- Bootstrap 3.3.2 -->
  <link href="/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
  <!-- FontAwesome 4.3.0 -->
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"
  />
  <!-- Ionicons 2.0.0 -->
  <link href="http://code.ionicframework.com/ionicons/2.0.0/css/ionicons.min.css" rel="stylesheet" type="text/css" />
  <!-- Theme style -->
  <link href="/dist/css/AdminLTE.min.css" rel="stylesheet" type="text/css" />
  <!-- AdminLTE Skins. Choose a skin from the css/skins 
         folder instead of downloading all of them to reduce the load. -->
  <link href="/dist/css/skins/_all-skins.min.css" rel="stylesheet" type="text/css" />
  <!-- iCheck -->
  <link href="/plugins/iCheck/flat/blue.css" rel="stylesheet" type="text/css" />
  <!-- Morris chart -->
  <!-- <link href="/plugins/morris/morris.css" rel="stylesheet" type="text/css" /> -->
  <!-- jvectormap -->
  <!-- <link href="/plugins/jvectormap/jquery-jvectormap-1.2.2.css" rel="stylesheet" type="text/css" /> -->
  <!-- Date Picker -->
  <link href="/plugins/datepicker/datepicker3.css" rel="stylesheet" type="text/css" />
  <!-- Daterange picker -->
  <link href="/plugins/daterangepicker/daterangepicker-bs3.css" rel="stylesheet" type="text/css" />
  <!-- bootstrap wysihtml5 - text editor -->
  <link href="/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css" rel="stylesheet" type="text/css" />

  <!-- g2g stylesheet -->
  <link href="/g2g/css/g2g.css" rel="stylesheet" type="text/css" />
  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

  <!-- Google maps -->
  <script src="https://maps.googleapis.com/maps/api/js"></script>
</head>

<body ng-app="G2GControlCenterApplication" class="skin-blue">
  <div class="wrapper">

    <header class="main-header">
      <% include ../partials/header %>
    </header>

    <!-- Left side column. contains the logo and sidebar -->
    <aside class="main-sidebar">
      <% include ../partials/side %>
    </aside>

    <!-- Contains the navbar and content of the page -->
    <div class="content-wrapper" ng-controller="HomePageContentController">
      <!-- Content Header (Page header) -->
      <section class="content-header">
        <h1>
          Tripdizer Dashboard
          <small>Control panel</small>
        </h1>
        <ol class="breadcrumb">
          <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
          <li class="active">Tripdizer Dashboard</li>
        </ol>
      </section>

      <!-- Main content -->
      <section class="content">
        <!-- Small boxes (Stat box) -->
        <% include ../partials/statesboxes %>
          <!-- /.row -->
          <div class="box box-primary">
            <div class="box-header with-border">
              <h3 class="box-title">Advanced Search</h3>
              <div class="box-tools pull-right">
                <button id="collapseExpandBtn" class="btn btn-box-tool" data-widget="collapse"><i id="collapseExpandIcon" class="fa fa-minus"></i></button>
              </div>
            </div>
            <!-- /.box-header -->
            <div class="box-body">
              <div class="row">
                <div class="col-xs-4">
                  <label>Request's Traveller Name</label>
                  <input type="text" placeHolder="Search by Traveller Name" class="form-control" id="nameSearchCriterion" ng-model="searchCriteria.customerName"
                  />
                </div>


              </div>
              <div class="row">
                <div class="col-xs-4">
                  <label>Request's Country</label>
                  <select class="form-control" ng-model="searchCriteria.restaurant" ng-options="restaurant.name for restaurant in restaurants track by restaurant.id">
									<option value="0">Select Country</option> 
		                      </select>
                </div>

                <div class="col-xs-4">
                  <label>Request's Status</label>
                  <select class="form-control" ng-model="searchCriteria.status" ng-options="status.title for status in statuses track by status.title">
									<option value="">Select Status</option> 
		                      </select>
                </div>
              </div>

              <div class="row">

                <div class="col-xs-4">
                  <label>Request Placed Between</label>
                  <div class="input-group">
                    <div class="input-group-addon">
                      <i class="fa fa-clock-o"></i>
                    </div>
                    <input type="text" class="form-control pull-right" id="placedTime" placeHolder="Placed within" />
                  </div>
                  <!-- /.input group -->
                </div>
              </div>
              <div class="row">
                <div class="col-xs-12">
                  <button class="btn btn-default pull-right" ng-click="searchOrders()">
	           					Search
	           				</button>
                  <button class="btn btn-default pull-right" ng-click="searchOrdersAndExport()">
	           					Search & Export
	           				</button>
                </div>
              </div>

            </div>
            <!-- /.box-body -->
          </div>
          <!-- /.box -->
          <div class="box box-primary">
            <div class="box-header with-border">
              <h3 class="box-title">Requests</h3>
              <div class="box-body">
                <div class="overlay" ng-show="refreshingOrders == true">
                  <i class="fa fa-refresh fa-spin"></i>
                </div>
                <div class="box-body table-responsive no-padding" ng-show="refreshingOrders == false">
                  <table id="example2" class="table table-bordered table-hover">
                    <thead>
                      <tr>
                        <th>ID</th>
                        <th>Traveler Name</th>
                        <th>Traveler Email</th>
                        <th>Traveler Mobile</th>
                        <th>Request Date</th>
                        <th>Request Status</th>
                        <th>Request Details</th>
                        <th>User</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr ng-repeat="order in currentOrders" ng-show="currentOrders.length != 0">
                        <td ng-bind="order.id"></td>
                        <td ng-bind="order.traveler.name"></td>
                        <td><a ng-click="showMailModal('traveler', order.traveler.emailAddress)"><i class="fa fa-envelope"></i> {{order.traveler.emailAddress}}</a></td>
                        <td ng-bind="order.traveler.mobile"></td>
                        <td ng-bind="order.date"></td>
                        <td>
                          <select ng-model="order.status" ng-change="changeOrderStatus(order)">
                            <option ng-repeat="status in statuses" ng-value="status.title">{{status.title}}</option>
                          </select>
                        </td>
                        <td>
                          <i class="ion-clipboard cursor" ng-click="openFullDetailsDialog(order.id)"> Full Details</i>
                        </td>
                        <td>
                          <div ng-show="order.userFullName == null">
                            <i class="cursor" ng-click="openAssignRequestToUser(order)"> Assign</i>
                          </div>
                          <div ng-show="order.userFullName != null">
                            {{order.userFullName}} | <i class="cursor" ng-click="openAssignRequestToUser(order)"> Re-assign</i>
                          </div>
                        </td>
                      </tr>
                      <tr ng-show="currentOrders.length == 0">
                        <td colspan="10">
                          <span class="text">There are no requests matching your selection ...</span>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <!-- /.box-body -->
              </div>
              <!-- /.box -->

              <!-- MODALS -->
              <div class="modal fade" id="assignUserModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                      <h4 class="modal-title" id="myModalLabel">Assign user to work on a request</h4>
                    </div>
                    <div class="modal-body">
                      <form role="form" id="orderForm">
                        <div class="box-body">
                          <div class="overlay" ng-show="loading == true">
                            <i class="fa fa-refresh fa-spin"></i>
                          </div>
                          <select class="form-control" ng-model="selectedUser" ng-options="user.fullName for user in users track by user.id"></select>
                        </div>
                        <!-- /.box-body -->
                      </form>
                    </div>
                    <div class="modal-footer">
                      <button class="btn btn-default pull-left" data-dismiss="modal">Close</button>
                      <button class="btn btn-default pull-right" ng-click="assignRequestToUser(currentOrder.id);">Assign</button>
                    </div>
                  </div>
                </div>
              </div>

              <div class="modal fade" id="orderDetailsModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                      <h4 class="modal-title" id="myModalLabel">Order Details</h4>
                    </div>
                    <div class="modal-body">
                      <form role="form" id="orderForm">
                        <div class="box-body">
                          <div class="overlay" ng-show="loading == true">
                            <i class="fa fa-refresh fa-spin"></i>
                          </div>
                          <div class="nav-tabs-custom">
                            <ul class="nav nav-tabs">
                              <li class="active"><a href="#requestTab" data-toggle="tab">Request</a></li>
                              <li><a href="#travelerTab" data-toggle="tab">Traveler</a></li>
                              <li><a href="#answersTab" data-toggle="tab">Q/A Answers</a></li>
                              <li><a href="#revenueTab" data-toggle="tab">Revenue & Profit</a></li>
                              <li><a href="#mailshistoryTab" data-toggle="tab">Mails History</a></li>
                            </ul>
                            <div class="tab-content">
                              <div class="tab-pane active" id="requestTab">
                                <div>
                                  <label for="id">ID</label>
                                  <input type="text" disabled class="form-control" id="id" ng-model="currentOrder.id">
                                  <label for="status">Status</label>
                                  <input type="text" disabled class="form-control" id="status" ng-model="currentOrder.status">
                                  <label for="placed">Placed</label>
                                  <input type="text" disabled class="form-control" id="placed" ng-model="currentOrder.date">
                                  <label for="comments">Comments</label>
                                  <textarea class="form-control" id="comments" ng-model="currentOrder.comments"></textarea>
                                  <label for="userFullName">Assigned User</label>
                                  <input type="text" disabled class="form-control" id="userFullName" ng-model="currentOrder.userFullName"></input>
                                </div>
                              </div>
                              <!-- /.tab-pane -->
                              <div class="tab-pane" id="travelerTab">
                                <div>
                                  <label for="customer">Traveler</label>
                                  <input type="text" disabled class="form-control" id="customer" ng-model="currentOrder.traveler.name">
                                  <label for="phone">Phone</label>
                                  <input type="text" disabled class="form-control" id="phone" ng-model="currentOrder.traveler.mobile">
                                  <label for="email">Email</label>
                                  <input type="text" disabled class="form-control" id="email" ng-model="currentOrder.traveler.emailAddress">
                                  <label for="dob">Date of birth</label>
                                  <input type="text" disabled class="form-control" id="dob" ng-model="currentOrder.traveler.dateOfBirth">
                                </div>
                              </div>
                              <!-- /.tab-pane -->
                              <div class="tab-pane" id="answersTab">
                                <table id="example2" class="table table-bordered table-hover">
                                  <thead>
                                    <tr>
                                      <th>Question</th>
                                      <th>Answer</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr ng-repeat="questionAnswer in currentOrder.questionAnswers" ng-show="currentOrder.questionAnswers.length != 0">
                                      <td ng-bind="questionAnswer.question.text">
                                      </td>
                                      <td ng-bind="questionAnswer.answer.answer">
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                                <div>
                                </div>
                              </div>
                              <!-- /.tab-pane -->
                              <div class="tab-pane" id="revenueTab">
                                <div>
                                  <label for="revenue">Revenue</label>
                                  <input type="number" min="0.00" step="1" class="form-control" id="revenue" ng-model="currentOrder.revenue">
                                  <label for="profit">Profit</label>
                                  <input type="number" min="0.00" step="1" class="form-control" id="profit" ng-model="currentOrder.profit">
                                </div>
                              </div>
                              <!-- /.tab-pane -->
                              <div class="tab-pane" id="mailshistoryTab">
                                <table class="table table-bordered table-hover">
                                  <thead>
                                    <tr>
                                      <th>Date</th>
                                      <th>Subject</th>
                                      <th>Files</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr ng-repeat="mail in currentOrder.mailsHistory" ng-show="currentOrder.questionAnswers.length != 0">
                                      <td ng-bind="mail.date"></td>
                                      <td ng-bind="mail.subject"></td>
                                      <td>
                                        <ul>
                                          <li ng-repeat="attachment in mail.attachments">{{attachment}}</li>
                                        </ul>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                            </div>
                            <!-- /.tab-content -->
                          </div>
                          <!-- nav-tabs-custom -->
                        </div>
                        <!-- /.box-body -->
                      </form>
                    </div>
                    <div class="modal-footer">
                      <button class="btn btn-default pull-left" data-dismiss="modal">Close</button>
                      <button class="btn btn-default pull-right" ng-click="updateOrder();">Save and close</button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- MODALS END -->
            </div>
          </div>
          <!-- tab content 1 -->

      </section>
      <!-- /.content -->
    </div>
    <!-- /.content-wrapper -->
    <footer class="main-footer">
      <% include ../partials/footer %>
    </footer>
  </div>
  <!-- ./wrapper -->

  <!-- jQuery 2.1.3 -->
  <script src="/plugins/jQuery/jQuery-2.1.3.min.js"></script>
  <!-- jQuery UI 1.11.2 -->
  <script src="http://code.jquery.com/ui/1.11.2/jquery-ui.min.js" type="text/javascript"></script>
  <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
  <script>
    $.widget.bridge('uibutton', $.ui.button);
  </script>
  <!-- Bootstrap 3.3.2 JS -->
  <script src="/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
  <!-- Morris.js charts -->
  <!-- <script src="http://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script> -->
  <!-- <script src="/plugins/morris/morris.min.js" type="text/javascript"></script> -->
  <!-- Sparkline -->
  <!-- <script src="/plugins/sparkline/jquery.sparkline.min.js" type="text/javascript"></script> -->
  <!-- jvectormap -->
  <!-- <script src="/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js" type="text/javascript"></script> -->
  <!-- <script src="/plugins/jvectormap/jquery-jvectormap-world-mill-en.js" type="text/javascript"></script> -->
  <!-- jQuery Knob Chart -->
  <!-- <script src="/plugins/knob/jquery.knob.js" type="text/javascript"></script> -->
  <!-- daterangepicker -->
  <script src="/plugins/daterangepicker/daterangepicker.js" type="text/javascript"></script>
  <!-- datepicker -->
  <script src="/plugins/datepicker/bootstrap-datepicker.js" type="text/javascript"></script>
  <!-- Bootstrap WYSIHTML5 -->
  <script src="/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js" type="text/javascript"></script>
  <!-- iCheck -->
  <script src="/plugins/iCheck/icheck.min.js" type="text/javascript"></script>
  <!-- Slimscroll -->
  <script src="/plugins/slimScroll/jquery.slimscroll.min.js" type="text/javascript"></script>
  <!-- FastClick -->
  <script src='/plugins/fastclick/fastclick.min.js'></script>
  <!-- AdminLTE App -->
  <script src="/dist/js/app.min.js" type="text/javascript"></script>

  <!-- AdminLTE dashboard demo (This is only for demo purposes) -->
  <!-- <script src="/dist/js/pages/dashboard.js" type="text/javascript"></script> -->

  <!-- AdminLTE for demo purposes -->
  <!-- <script src="/dist/js/demo.js" type="text/javascript"></script> -->

  <!-- angular js library and g2g angular js controllers -->
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script>

  <!-- textAngular -->
  <script src='http://cdnjs.cloudflare.com/ajax/libs/textAngular/1.5.0/textAngular-rangy.min.js'></script>
  <script src='http://cdnjs.cloudflare.com/ajax/libs/textAngular/1.5.0/textAngular-sanitize.min.js'></script>
  <script src='http://cdnjs.cloudflare.com/ajax/libs/textAngular/1.5.0/textAngular.min.js'></script>

  <script src="/g2g/js/libraries/socket.io.js" type="text/javascript"></script>
  <script src="/g2g/js/G2GControlCenterApplication.js" type="text/javascript"></script>
  <script src="/g2g/js/HomePageContentController.js" type="text/javascript"></script>
  <script src="/g2g/js/HeaderContentController.js" type="text/javascript"></script>

</body>

</html>